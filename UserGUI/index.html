<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Geomatics4BioSystems</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Geomatics for Biological Systems">
    <meta name="author" content="X. Arteaga; J. Olmos">
    <script type='text/javascript'>
        /**
         * Stylesheets loader with redundant sources
         * @param url Is the URL to the priority resource (normally to the original file in the CDN)
         * @param url2 Is teh secondary resource which is loaded in case of fail of the first (normally the local one or 'null' if none).
         */
        function asyncLoadStyle(url, url2) {
            var tag = document.createElement("link");
            tag.rel = "stylesheet";
            tag.type = "text/css";
            tag.href = url;
            tag.async = false;
            if (url2 != null) // If not 'null' load the second file in case of error.
                tag.onerror = function () {
                    asyncLoadStyle(url2, null);
                };
            document.getElementsByTagName('head')[0].appendChild(tag);
        }
        if (document.domain == "" || document.domain == "localhost") {
            asyncLoadStyle('http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.no-icons.min.css', 'css/bootstrap.min.css');
        } else {
            asyncLoadStyle('http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.no-icons.min.css', 'bs.css');
            asyncLoadStyle('http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.no-icons.min.css', 'bs-res.css');
        }
    </script>
    <!-- Style for D3 graphs -->
    <style>
        .axis path,
        .axis line {
            fill: none;
            stroke: #000;
            shape-rendering: crispEdges;
        }

        .x.axis path {
            display: none;
        }

        .line {
            fill: none;
            stroke: steelblue;
            stroke-width: 1.5px;
        }
    </style>
</head>

<!-- BODY -->
<body>
<div class="navbar navbar-inverse">
    <div class="navbar-inner">
        <div class="container">
            <button type="button" class="btn btn-navbar"
                    data-toggle="collapse" data-target=".nav-collapse"></button>
            <a class="brand" href="#">Geomatics4BioSystems</a>

            <div class="nav-collapse collapse">
                <ul class="nav">
                    <li class="active"><a href="./index.html">This</a></li>
                    <li class=""><a href="https://github.com/xarteaga/RESTduino">Project Repository</a></li>
                    <li class=""><a href="http://arduino.cc/">Arduino homepage</a></li>
                    <li class=""><a href="http://www.tinkerkit.com/">Tinker kit! Homepage</a></li>
                    <li class=""><a href="http://getbootstrap.com/">Bootstrap homepage</a></li>
                </ul>
            </div>
        </div>
    </div>
</div>
<div id="modals"></div>
<div id="tabControl" class="container tabbable">
<ul class="nav nav-tabs">
    <div id="tabTopPadding"></div>
    <li class="active"><a href="#scandevices" data-toggle="tab"
                          onclick="stopAutoRead()">Scan devices</a></li>
    <li><a href="#confdev" data-toggle="tab" onclick=
            "stopAutoRead()">Configure Device</a></li>
    <li><a href="#confports" data-toggle="tab" onclick=
            "stopAutoRead()">Ports</a></li>
    <li><a href="#monitor" data-toggle="tab" onclick=
            "stopAutoRead()">Monitor</a></li>
    <div id="tabBottomPadding"></div>
</ul>
<div class="tab-content">
<div id="scandevices" class="tab-pane active">
    <h2>Scan devices</h2>

    <div class="row-fluid">
        <div class="span4">
            <form onsubmit="event.preventDefault()">
                <div class="form-group">
                    <label for="startIP">Start IP Address</label>
                    <input type="text" class="form-control" id="startIP" value="192.168.10.1"
                           onkeydown="if (event.keyCode==13) startDiscovery()">
                </div>
                <div class="form-group">
                    <label for="endIP">Stop IP Address</label>
                    <input type="text" class="form-control" id="endIP" value="192.168.10.255"
                           onkeydown="if (event.keyCode==13) startDiscovery()">
                </div>
                <div class="input-group">
                    <label class="checkbox"><input type="checkbox" id="showOffline" value="__option__"> Show offline IP
                        devices</label>
                </div>
                <div id="scanCtrl">
                    <button type="button" class="btn btn-success" onclick="startDiscovery()">Start</button>
                    <button type="button" class="btn btn-default" onclick="stopDiscovery()">Stop</button>
                </div>
            </form>
            <br>
            <br>
            <br>
            <label>Progress:</label>

            <div class="progress progress-striped active">
                <div id="progressbar" class="bar" role="progressbar" aria-valuenow=
                        "0" aria-valuemin="0" aria-valuemax="100" style="width: 0">
<span id="progresslbl" class="sr-only" text-align=
        "centered"></span></div>
            </div>
        </div>
        <div class="span3 offset1">
            <table class="table table-hover">
                <caption>Found Devices</caption>
                <thead>
                <tr>
                    <th align="center">IP Address</th>
                    <th align="center">Status</th>
                </tr>
                </thead>
                <tbody id="devicesTable">
                <tr>
                    <td>...</td>
                    <td align="center"><span class=
                                                     "label label-default">Unchecked</span></td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
    <div class="well">
        <h3>Tips</h3>

        <p>Set the IP range for scanning devices in the network and click
            the button 'Scan Devices'. Your browser will list the IPs of all
            the network devices available in the IP range.</p>

        <p>In case of finding an Arduino server the Status will appear as
            (<span class="label label-success">Online Arduino</span>). If the
            detected device is any other kind of network device the Status will
            appear as (<span class="label label-warning">Other
Device</span>).</p>

        <p>In case that you want to see all the scanned IP addresses, check
            the option "Show offline IP devices".</p>

        <p>After scanning the network devices you can copy the IP Address
            of any Arduino server in order to monitor it remotely.</p>
    </div>
</div>
<div id="confdev" class="tab-pane">
    <h2>Configure device IP and Name</h2>

    <form onsubmit="event.preventDefault()"><label>New name for the device</label>
        <div class='btn-group'>
            <button id='setNewIp' data-toggle='dropdown'
                    class='btn btn-default dropdown-toggle' align='right' value=''>New
                IP
            </button>
            <ul class='dropdown-menu'>
                <li><a type="button" onclick=
                        'configDevProtected("set/a0")'>192.168.10.2:80/24</a></li>
                <li><a type="button" onclick=
                        'configDevProtected("set/a1")'>192.168.10.130:8080/26</a></li>
                <li><a type="button" onclick=
                        'configDevProtected("set/a2")'>10.0.1.2:80/24</a></li>
                <li><a type="button" onclick=
                        'configDevProtected("set/a3")'>10.0.1.130:8080/26</a></li>
            </ul>
        </div>
    </form>
    <form onsubmit="event.preventDefault(); configDevProtected('set/n' + document.getElementById('newName').value.replace(' ', '_').substring(0,15))">
        <div class="form-group input-append"><label for="newName">New name
            for the device</label> <input type="text" class="form-control" id=
                "newName" placeholder="My Arduino">
            <button type="button submit" class="btn btn-info">
                Change Name
            </button>
        </div>
    </form>
    <form onsubmit="event.preventDefault()"><label>Sampling Time</label>
        <div class='btn-group'>
            <button id='setNewSamplingTime' data-toggle='dropdown'
                    class='btn btn-default dropdown-toggle' align='right' value=''>New sampling time
            </button>
            <ul class='dropdown-menu'>
                <li><a type="button" onclick=
                        'configDevProtected("set/t0")'>1 second</a></li>
                <li><a type="button" onclick=
                        'configDevProtected("set/t1")'>5 seconds</a></li>
                <li><a type="button" onclick=
                        'configDevProtected("set/t2")'>10 seconds</a></li>
                <li><a type="button" onclick=
                        'configDevProtected("set/t3")'>1 minute</a></li>
                <li><a type="button" onclick=
                        'configDevProtected("set/t4")'>5 minute</a></li>
                <li><a type="button" onclick=
                        'configDevProtected("set/t5")'>10 minute</a></li>
            </ul>
        </div>
    </form>
    <form onsubmit="event.preventDefault()"><label>Packets payload size</label>
        <div class='btn-group'>
            <button id='setPayloadSize' data-toggle='dropdown'
                    class='btn btn-default dropdown-toggle' align='right' value=''>New Packet Size [bytes]
            </button>
            <ul class='dropdown-menu'>
                <li><a type="button" onclick=
                        'configDevProtected("set/p0")'>512 Bytes</a></li>
                <li><a type="button" onclick=
                        'configDevProtected("set/p1")'>768 Bytes</a></li>
                <li><a type="button" onclick=
                        'configDevProtected("set/p2")'>1024 Bytes</a></li>
                <li><a type="button" onclick=
                        'configDevProtected("set/p3")'>1280 Bytes</a></li>
            </ul>
        </div>
    </form>
    <div class="well">
        <h3>Tips</h3>

        <p>Configure your LOCAL Arduino server IP address. You only can choose among a limited number of IP addresses,
            net masks and server ports. After selecting a new IP Address you must reset your Arduino board in order to
            enforce the new IP address and configure your PC with an IP belonging to the new IP address range.
        </p>

        <p>You can also change your LOCAL Arduino name or identifier by writing a new name (shorter than 15 characters,
            without special characters) and clicking "Change name".</p>
    </div>
</div>
<div id="confports" class="tab-pane">
    <h2>Configure device ports</h2>

    <form onsubmit="event.preventDefault();configDev('config')">
        <div class="form-group input-append" onsubmit="return false;">
            <label for="ipAddress">IP Address of the device</label>
            <input type="text" class="form-control" id="ipAddress">
            <button type="submit" class="btn btn-info" onclick="configDev('config')">Connect</button>
        </div>
    </form>
    <div class="row-fluid">
        <div class="span2 offset2"><br>
            <br>
            <form id="inputs" align="center" onsubmit="event.preventDefault()">
                <script type="text/javascript">
                    for (var i = 0; i < 6; i++) {
                        document.write("<div class='btn-group'>");
                        document.write("<button id='an" + i + "' data-toggle='dropdown' class='btn btn-default dropdown-toggle' align='right'>Void <span class='caret'><\/span><\/button>");
                        document.write("<ul class='dropdown-menu'>");
                        document.write("<li><a onclick='configDevProtected(\"set/i" + i + "r\")'>Raw<\/a><\/li>");
                        document.write("<li><a onclick='configDevProtected(\"set/i" + i + "t\")'>Temperature<\/a><\/li>");
                        document.write("<li><a onclick='configDevProtected(\"set/i" + i + "p\")'>Potentiometer<\/a><\/li>");
                        document.write("<li><a onclick='configDevProtected(\"set/i" + i + "l\")'>Light<\/a><\/li>");
                        document.write("<li><a onclick='configDevProtected(\"set/i" + i + "b\")'>Logical<\/a><\/li>");
                        document.write("<li class='divider'><\/li>");
                        document.write("<li><a onclick='configDevProtected(\"set/i" + i + "e\")'>Void<\/a><\/li>");
                        document.write("<\/ul>");
                        document.write("<\/div>");
                        document.write("<br><br>")
                    }
                    ;
                </script>
            </form>
        </div>
        <div class="span4" align="center">
            <h3 id="devName"><i>Not connected</i></h3>
            <div id="shieldContainer"></div>
            <script type='text/javascript'>
                function asyncLoadImage(url, url2) {
                    var tag = document.createElement("img");
                    tag.src = url;
                    tag.align = "middle";
                    tag.alt = "TinkerKit Shield";
                    tag.async = false;
                    if (url2 != null) // If not 'null' load the second file in case of error.
                        tag.onerror = function () {
                            asyncLoadStyle(url2, null);
                        };
                    document.getElementById('shieldContainer').appendChild(tag);
                }
                if (document.domain == "" || document.domain == "localhost") {
                    asyncLoadImage('https://github.com/xarteaga/RESTduino/blob/master/UserGUI/img/tinkershield.jpg?raw=true', 'img/tinkershield.jpg');
                } else {
                    asyncLoadImage('https://github.com/xarteaga/RESTduino/blob/master/UserGUI/img/tinkershield.jpg?raw=true', 'shield.jpg');
                }
                ;


            </script>
        </div>
        <div class="span2"><br>
            <br>

            <form align="center">
                <script type="text/javascript">
                    for (var i = 0; i < 6; i++) {

                        document.write("<div class='btn-group'>");
                        document.write("<button id='out" + i + "' data-toggle='dropdown' class='btn btn-default dropdown-toggle' align='right'>Void <span class='caret'><\/span><\/button>");
                        document.write("<ul class='dropdown-menu'>");
                        if (i != 0 && i != 1) {
                            document.write("<li><a onclick='configDevProtected(\"set/o" + i + "b\")'>Logical<\/a><\/li>");
                            document.write("<li class='divider'><\/li>");
                            document.write("<li><a onclick='configDevProtected(\"set/o" + i + "e\")'>Void<\/a><\/li>");
                        } else {
                            document.write("<li><a>Reserved<\/a><\/li>");
                        }
                        document.write("<\/ul>");
                        document.write("<\/div>");
                        document.write("<br><br>")
                    }
                    ;

                </script>
            </form>
        </div>
    </div>
    <div class="well">
        <h3>Tips</h3>

        <p>Select an Arduino in the network by typing its IP. Click "Connect" to load its configuration. If the Arduino
            IP is on your local network you can configure the input ports by clicking on the buttons and selecting the
            type of input.</p>

        <p>In case of leaving an input or output unconnected, select the "Void" option.</p>

        <p><span class="label label-warning">Warning</span> Never connect anything to the outputs "O0" or "O1". They are
            reserved for Arduino internal usage.</p>

        <h4>Port Types</h4>

        <p><span class="label label-info">Raw</span> This port type shows the raw value read by the Arduino A/D
            converter. The value is represented as a 10 bit unsigned integer, from 0 to 1023.</p>

        <p><span class="label btn-danger">Temperature</span> This port type shows the temperature read from a thermistor
            connected at an analog input. The value is represented in Celsius degrees with
            a precision of one decimal digit.</p>

        <p><span class="label label-success">Potentiometer</span> This port type shows the rotation angle of a
            potentiometer connected at an analog input. The value is represented as a percentage with a
            precision of one decimal digit.</p>

        <p><span class="label label-warning">Light</span> This port type shows a measure of the illumination level of a
            LDR connected at an analog input. The value is represented as a 10 bit unsigned
            integer, from 0 to 1023 (raw value)</p>

        <p><span class="label btn-primary">Logical</span> This port type shows the logical level read from a switch
            connected at a digital input. The value is represented with using logical states: True
            (On) or False (Off).</p>
    </div>
</div>
<div id="monitor" class="tab-pane">
    <h2>Read Values</h2>

    <div class="row-fluid">
        <div class="span4">
            <form onsubmit="event.preventDefault(); startAutoRead()">
                <div class="form-group input-append">
                    <label for="ipAddress2">IP Address of the device</label>
                    <input type="text" class="form-control" id="ipAddress2"
                           onkeydown="if (event.keyCode == 13) startAutoRead()">
                </div>
                <div class="form-group">
                    <label for="refreshTime">Refresh time [s]</label>
                    <input type="number" class="form-control" id="refreshTime" value="5"
                           onkeydown="if (event.keyCode == 13) startAutoRead()">
                </div>
                <div id="startStopButtons">
                    <button id="startRead" type="button"
                            class="btn btn-success" onclick="startAutoRead()">Start
                    </button>
                    <button id="stopRead" type="button" class="btn btn-default"
                            onclick="stopAutoRead()">Stop
                    </button>
                </div>
            </form>
        </div>
        <h3 id="devName2" align="center"><i>Not Connected</i></h3>

        <div class="span3 offset1">
            <table class="table table-hover">
                <caption>Analog inputs</caption>
                <thead>
                <tr>
                    <th align="center">Port</th>
                    <th align="center">Value</th>
                </tr>
                </thead>
                <tbody id="analogReads">
                <tr>
                    <td>...</td>
                    <td align="center">Void</td>
                </tr>
                </tbody>
            </table>
        </div>
        <div class="span3">
            <table class="table table-hover">
                <caption>Actuators</caption>
                <thead>
                <tr>
                    <th text-align="center">Port</th>
                    <th text-align="center">Value</th>
                </tr>
                </thead>
                <tbody id="actuators">
                <tr>
                    <td>...</td>
                    <td align="center">Void</td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
    <div class="well">
        <h3>Tips</h3>

        <p>Type an Arduino IP address and a refresh time. Click the "Start"
            button to start reading data from the sensors at the selected
            Arduino Server.</p>

        <p>Click the "Stop" button to stop reading data from the selected
            Arduino.</p>

        <p>Click "On/Off" to toggle the actuators at the selected Arduino
            Server.</p>

        <p><span class="label label-warning">Warning</span> Due to the fact
            that Arduino processing capabilities are limited, it only allows
            one simultaneous request. In case of two or more requests at same
            time your browser will pop up a notice window.</p>
    </div>
</div>
</div>
</div>
<hr>
<p>Developed by X. Arteaga, 2013</p>

<script type="text/javascript">

    function asyncLoadScript(url, url2) {
        var tag = document.createElement("script");
        tag.type = "text/javascript";
        tag.src = url;
        tag.async = false;
        if (url2 != null)
            tag.onerror = function () {
                asyncLoadScript(url2, null);
            };
        document.getElementsByTagName('head')[0].appendChild(tag);
    }

    if (document.domain == "" || document.domain == "localhost") {
        asyncLoadScript('http://code.jquery.com/jquery-1.10.1.min.js', 'js/jquery.min.js');
        asyncLoadScript('http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js', 'js/bootstrap.min.js');
        asyncLoadScript('http://underscorejs.org/underscore-min.js', null);
        asyncLoadScript('http://d3js.org/d3.v3.js', null);
        asyncLoadScript('js/control.js', null);
    } else {
        asyncLoadScript('http://code.jquery.com/jquery-1.10.1.min.js', 'jquery.js');
        asyncLoadScript('http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js', 'bs.js');
        asyncLoadScript('http://underscorejs.org/underscore-min.js', null);
        asyncLoadScript('http://d3js.org/d3.v3.js', null);
        asyncLoadScript('control.js', null);
    }
    ;


</script>
</body>
</html>
